<!DOCTYPE html><html class="hide-aside" lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="Access-Control-Allow-Origin" content="*"><meta name="viewport" content="width=device-width,initial-scale=1"><title>EulerProject刷题记录 - Mathematica | Larry_Eppes's Trivia Collection Site</title><meta name="keywords" content="math,数学,算法,Mathematica"><meta name="author" content="Larry Eppes"><meta name="copyright" content="Larry Eppes"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Problem 23A perfect number is a number for which the sum of its proper divisors is exactly equal to the number. For example, the sum of the proper divisors of $28$ would be $1 + 2 + 4 + 7 + 14 &#x3D; 28$,">
<meta property="og:type" content="article">
<meta property="og:title" content="EulerProject刷题记录 - Mathematica">
<meta property="og:url" content="https://larryeppes.site/EulerProject%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20-%20Mathematica/index.html">
<meta property="og:site_name" content="Larry_Eppes&#39;s Trivia Collection Site">
<meta property="og:description" content="Problem 23A perfect number is a number for which the sum of its proper divisors is exactly equal to the number. For example, the sum of the proper divisors of $28$ would be $1 + 2 + 4 + 7 + 14 &#x3D; 28$,">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://larryeppes.site/img/0072Vf1pgy1fodqnrlkfxj31110q77sr.jpg">
<meta property="article:published_time" content="2022-11-26T03:16:54.000Z">
<meta property="article:modified_time" content="2024-01-09T11:38:24.865Z">
<meta property="article:author" content="Larry Eppes">
<meta property="article:tag" content="math">
<meta property="article:tag" content="数学">
<meta property="article:tag" content="算法">
<meta property="article:tag" content="Mathematica">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://larryeppes.site/img/0072Vf1pgy1fodqnrlkfxj31110q77sr.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://larryeppes.site/EulerProject%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20-%20Mathematica/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="baidu-site-verification" content="codeva-QF67PrzONS"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-9013320849898771',
  enable_page_level_ads: 'true'
});</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?84e40f8920188037174fb8bffa84a266";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-1JJJG9G67C"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-1JJJG9G67C');
</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'mediumZoom',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-01-09 19:38:24'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/head.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">52</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">78</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa-solid fa-house-chimney"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> Math</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6"><i class="fa-fw fa-solid fa-book-quran"></i><span> 高等数学</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6%E5%88%86%E6%9E%90"><i class="fa-fw fa-solid fa-book-skull"></i><span> 数学分析</span></a></li><li><a class="site-page" href="/categories/%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0"><i class="fa-fw fa-solid fa-book-journal-whills"></i><span> 抽象代数</span></a></li><li><a class="site-page" href="/categories/%E6%B3%9B%E5%87%BD%E5%88%86%E6%9E%90"><i class="fa-fw fa-solid fa-book-skull"></i><span> 泛函分析</span></a></li><li><a class="site-page" href="/categories/%E5%AE%9E%E5%8F%98%E5%87%BD%E6%95%B0"><i class="fa-fw fa-solid fa-book-tanakh"></i><span> 实变函数</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/%E5%AE%9A%E4%B9%89"><i class="fa-fw fa-regular fa-star"></i><span> Defs</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E5%AE%9A%E7%90%86"><i class="fa-fw fa-solid fa-star"></i><span> Thms</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa-solid fa-box-open"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa-solid fa-comment-dots"></i><span> 说说</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/shuoshuo/"><i class="fa-fw fa-solid fa-comment-dots"></i><span> 说说</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa-solid fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa-solid fa-folder-tree"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-solid fa-user-large"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/0072Vf1pgy1fodqnrlkfxj31110q77sr.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Larry_Eppes's Trivia Collection Site</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fa-solid fa-magnifying-glass fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa-solid fa-house-chimney"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> Math</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6"><i class="fa-fw fa-solid fa-book-quran"></i><span> 高等数学</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6%E5%88%86%E6%9E%90"><i class="fa-fw fa-solid fa-book-skull"></i><span> 数学分析</span></a></li><li><a class="site-page" href="/categories/%E6%8A%BD%E8%B1%A1%E4%BB%A3%E6%95%B0"><i class="fa-fw fa-solid fa-book-journal-whills"></i><span> 抽象代数</span></a></li><li><a class="site-page" href="/categories/%E6%B3%9B%E5%87%BD%E5%88%86%E6%9E%90"><i class="fa-fw fa-solid fa-book-skull"></i><span> 泛函分析</span></a></li><li><a class="site-page" href="/categories/%E5%AE%9E%E5%8F%98%E5%87%BD%E6%95%B0"><i class="fa-fw fa-solid fa-book-tanakh"></i><span> 实变函数</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/categories/%E5%AE%9A%E4%B9%89"><i class="fa-fw fa-regular fa-star"></i><span> Defs</span></a></div><div class="menus_item"><a class="site-page" href="/categories/%E5%AE%9A%E7%90%86"><i class="fa-fw fa-solid fa-star"></i><span> Thms</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa-solid fa-box-open"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa-solid fa-comment-dots"></i><span> 说说</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/shuoshuo/"><i class="fa-fw fa-solid fa-comment-dots"></i><span> 说说</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa-solid fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa-solid fa-folder-tree"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa-solid fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-solid fa-user-large"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">EulerProject刷题记录 - Mathematica</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-11-26T03:16:54.000Z" title="发表于 2022-11-26 11:16:54">2022-11-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-01-09T11:38:24.865Z" title="更新于 2024-01-09 19:38:24">2024-01-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AE%97%E6%B3%95/">算法</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>18分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/EulerProject%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20-%20Mathematica/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/EulerProject%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20-%20Mathematica/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="Problem-23"><a href="#Problem-23" class="headerlink" title="Problem 23"></a>Problem 23</h3><p>A perfect number is a number for which the sum of its proper divisors is exactly equal to the number. For example, the sum of the proper divisors of $28$ would be $1 + 2 + 4 + 7 + 14 = 28$, which means that $28$ is a perfect number.</p>
<p>A number $n$ is called deficient if the sum of its proper divisors is less than $n$ and it is called abundant if this sum exceeds $n$.</p>
<p>As $12$ is the smallest abundant number, $1 + 2 + 3 + 4 + 6 = 16$, the smallest number that can be written as the sum of two abundant numbers is $24$. By mathematical analysis, it can be shown that all integers greater than $28123$ can be written as the sum of two abundant numbers. However, this upper limit cannot be reduced any further by analysis even though it is known that the greatest number that cannot be expressed as the sum of two abundant numbers is less than this limit.</p>
<p>Find the sum of all the positive integers which cannot be written as the sum of two abundant numbers.</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">abundant</span> <span class="operator">=</span> <span class="built_in">Select</span><span class="punctuation">[</span><span class="built_in">Range</span><span class="punctuation">[</span><span class="number">28123</span><span class="punctuation">]</span><span class="operator">,</span> <span class="built_in">Total</span><span class="operator">@</span><span class="built_in">Divisors</span><span class="punctuation">[</span><span class="type">#</span><span class="punctuation">]</span> <span class="operator">&gt;</span> <span class="number">2</span> <span class="type">#</span> <span class="operator">&amp;</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">lists</span> <span class="operator">=</span> <span class="built_in">Range</span><span class="punctuation">[</span><span class="number">28123</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="built_in">Dynamic</span><span class="punctuation">[</span><span class="variable">see</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">(</span><span class="variable">see</span> <span class="operator">=</span> <span class="type">#</span><span class="operator">;</span> <span class="variable">lists</span> <span class="operator">=</span> <span class="built_in">Complement</span><span class="punctuation">[</span><span class="variable">lists</span><span class="operator">,</span> <span class="type">#</span> <span class="operator">+</span> <span class="variable">abundant</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">&amp;</span> <span class="operator">/@</span> <span class="variable">abundant</span><span class="operator">;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">lists</span> <span class="operator">//</span> <span class="built_in">Total</span></span><br></pre></td></tr></table></figure>
<p>其他解答:</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">n</span> <span class="operator">=</span> <span class="number">28123</span><span class="operator">;</span> <span class="variable">s</span> <span class="operator">=</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="operator">;</span></span><br><span class="line"><span class="variable">a</span> <span class="operator">=</span> <span class="built_in">Reap</span><span class="punctuation">[</span><span class="built_in">Array</span><span class="punctuation">[</span><span class="built_in">If</span><span class="punctuation">[</span><span class="built_in">DivisorSigma</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">,</span> <span class="type">#</span><span class="punctuation">]</span> <span class="operator">-</span> <span class="type">#</span> <span class="operator">&gt;</span> <span class="type">#</span><span class="operator">,</span> <span class="built_in">Sow</span><span class="operator">@</span><span class="type">#</span><span class="punctuation">]</span> <span class="operator">&amp;,</span> <span class="variable">n</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">2</span><span class="operator">,</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">p</span> <span class="operator">=</span> <span class="built_in">Position</span><span class="punctuation">[</span><span class="variable">a</span><span class="operator">,</span> <span class="type">x_</span> <span class="operator">/;</span> <span class="variable">x</span> <span class="operator">&gt;</span> <span class="variable">n</span><span class="operator">/</span><span class="number">2</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">,</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="built_in">Do</span><span class="punctuation">[</span><span class="variable">s</span> <span class="operator">=</span> <span class="built_in">Union</span><span class="punctuation">[</span><span class="variable">s</span><span class="operator">,</span> <span class="variable">a</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="variable">i</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">+</span> <span class="built_in">Drop</span><span class="punctuation">[</span><span class="variable">a</span><span class="operator">,</span> <span class="variable">i</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">i</span><span class="operator">,</span> <span class="variable">p</span><span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br><span class="line"><span class="built_in">Tr</span><span class="operator">@</span><span class="built_in">Complement</span><span class="punctuation">[</span><span class="built_in">Range</span><span class="operator">@</span><span class="variable">n</span><span class="operator">,</span> <span class="variable">s</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-24"><a href="#Problem-24" class="headerlink" title="Problem 24"></a>Problem 24</h3><p>A permutation is an ordered arrangement of objects. For example, 3124 is one possible permutation of the digits $1, 2, 3$ and $4$. If all of the permutations are listed numerically or alphabetically, we call it lexicographic order. The lexicographic permutations of $0, 1$ and $2$ are:</p>
<blockquote>
<p>012   021   102   120   201   210</p>
</blockquote>
<p>What is the millionth lexicographic permutation of the digits $0, 1, 2, 3, 4, 5, 6, 7, 8$ and $9$?</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">lists</span> <span class="operator">=</span> <span class="built_in">Permutations</span><span class="punctuation">[</span><span class="built_in">Range</span><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">]</span> <span class="operator">-</span> <span class="number">1</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="number">10</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">lists</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">1000000</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">//</span> <span class="built_in">FromDigits</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-25"><a href="#Problem-25" class="headerlink" title="Problem 25"></a>Problem 25</h3><p>The Fibonacci sequence is defined by the recurrence relation:</p>
<blockquote>
<p> $F_n = F_{n−1} + F_{n−2}$, where $F_1 = 1$ and $F_2 = 1$.</p>
</blockquote>
<p>Hence the first $12$ terms will be:</p>
<p>  $F_1 = 1$<br>  $F_2 = 1$<br>  $F_3 = 2$<br>  $F_4 = 3$<br>  $F_5 = 5$<br>  $F_6 = 8$<br>  $F_7 = 13$<br>  $F_8 = 21$<br>  $F_9 = 34$<br>  $F_{10} = 55$<br>  $F_{11} = 89$<br>  $F_{12} = 144$</p>
<p>The $12$th term, $F_{12}$, is the first term to contain three digits.</p>
<p>What is the index of the first term in the Fibonacci sequence to contain $1000$ digits?</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">n</span> <span class="operator">=</span> <span class="number">12</span><span class="operator">;</span></span><br><span class="line"><span class="built_in">While</span><span class="punctuation">[</span><span class="built_in">Length</span><span class="operator">@</span><span class="built_in">IntegerDigits</span><span class="operator">@</span><span class="built_in">Fibonacci</span><span class="punctuation">[</span><span class="variable">n</span><span class="punctuation">]</span> <span class="operator">&lt;</span> <span class="number">1000</span><span class="operator">,</span> <span class="variable">n</span><span class="operator">++</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">n</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-27"><a href="#Problem-27" class="headerlink" title="Problem 27"></a>Problem 27</h3><p>Euler discovered the remarkable quadratic formula:</p>
<script type="math/tex; mode=display">
n^2+n+41</script><p>It turns out that the formula will produce 40 primes for the consecutive integer values $0 \leq n \leq 39$. However, when $n=40$, $40^2+40+41=40(40+1)+41$ is divisible by $41$, and certainly when $n=41$, $41^2+41+41$ is clearly divisible by $41$.</p>
<p>The incredible formula $n^2-79 n+1601$ was discovered, which produces $80$ primes for the consecutive values $0 \leq n \leq 79$. The product of the coefficients, $-79$ and $1601$, is $-126479$.</p>
<p>Considering quadratics of the form: $n^2+a n+b$, where $|a|&lt;1000$ and $|b| \leq 1000$ where $|n|$ is the modulus/absolute value of $n$ e.g. $|11|=11$ and $|-4|=4$</p>
<p>Find the product of the coefficients, $a$ and $b$, for the quadratic expression that produces the maximum number of primes for consecutive values of $n$, starting with $n=0$.</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">len</span><span class="punctuation">[</span><span class="type">a_</span><span class="operator">,</span> <span class="type">b_</span><span class="punctuation">]</span> <span class="operator">:=</span> <span class="built_in">Module</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">n</span> <span class="operator">=</span> <span class="number">0</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="built_in">While</span><span class="punctuation">[</span><span class="built_in">PrimeQ</span><span class="punctuation">[</span><span class="variable">n</span><span class="operator">^</span><span class="number">2</span> <span class="operator">+</span> <span class="variable">a</span> <span class="variable">n</span> <span class="operator">+</span> <span class="variable">b</span><span class="punctuation">]</span><span class="operator">,</span> <span class="variable">n</span><span class="operator">++</span><span class="punctuation">]</span><span class="operator">;</span> <span class="variable">n</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="built_in">SortBy</span><span class="punctuation">[</span><span class="built_in">Flatten</span><span class="punctuation">[</span></span><br><span class="line">   <span class="built_in">Table</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">a</span><span class="operator">,</span> <span class="variable">b</span><span class="operator">,</span> <span class="variable">len</span><span class="punctuation">[</span><span class="variable">a</span><span class="operator">,</span> <span class="variable">b</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">a</span><span class="operator">,</span> <span class="operator">-</span><span class="number">1000</span><span class="operator">,</span> <span class="number">1000</span><span class="operator">,</span> <span class="number">1</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">b</span><span class="operator">,</span> <span class="operator">-</span><span class="number">1000</span><span class="operator">,</span> <span class="number">1000</span><span class="operator">,</span> <span class="number">1</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="operator">,</span></span><br><span class="line">    <span class="number">1</span><span class="punctuation">]</span><span class="operator">,</span> <span class="built_in">Last</span><span class="punctuation">]</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="comment">(*&#123;-61, 971, 71&#125;*)</span></span><br><span class="line"><span class="operator">-</span><span class="number">61</span><span class="operator">*</span><span class="number">971</span></span><br></pre></td></tr></table></figure>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">f</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="type">a_</span><span class="operator">,</span> <span class="type">b_</span><span class="punctuation">&#125;</span><span class="punctuation">]</span> <span class="operator">:=</span> <span class="punctuation">(</span><span class="built_in">For</span><span class="punctuation">[</span><span class="variable">n</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">,</span> <span class="built_in">PrimeQ</span><span class="punctuation">[</span><span class="variable">n</span><span class="operator">^</span><span class="number">2</span> <span class="operator">+</span> <span class="variable">a</span> <span class="variable">n</span> <span class="operator">+</span> <span class="variable">b</span><span class="punctuation">]</span><span class="operator">,</span> <span class="variable">n</span><span class="operator">++</span><span class="punctuation">]</span><span class="operator">;</span> <span class="punctuation">&#123;</span><span class="variable">n</span><span class="operator">,</span> <span class="variable">a</span> <span class="variable">b</span><span class="punctuation">&#125;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">Timing</span><span class="operator">@</span><span class="built_in">Last</span><span class="operator">@</span></span><br><span class="line">  <span class="built_in">Sort</span><span class="punctuation">[</span><span class="variable">f</span> <span class="operator">/@</span> <span class="built_in">Flatten</span><span class="punctuation">[</span><span class="built_in">Table</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">a</span><span class="operator">,</span> <span class="variable">b</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">a</span><span class="operator">,</span> <span class="operator">-</span><span class="number">999</span><span class="operator">,</span> <span class="number">999</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">b</span><span class="operator">,</span> <span class="operator">-</span><span class="number">999</span><span class="operator">,</span> <span class="number">999</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="operator">,</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">lengthOfQuadraticPrimes</span><span class="punctuation">[</span><span class="type">a_Integer</span><span class="operator">,</span> <span class="type">b_Integer</span><span class="punctuation">]</span> <span class="operator">:=</span> </span><br><span class="line">  <span class="built_in">Block</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">n</span> <span class="operator">=</span> <span class="number">0</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="built_in">While</span><span class="punctuation">[</span><span class="built_in">PrimeQ</span><span class="punctuation">[</span><span class="variable">n</span><span class="operator">^</span><span class="number">2</span> <span class="operator">+</span> <span class="variable">a</span> <span class="variable">n</span> <span class="operator">+</span> <span class="variable">b</span><span class="punctuation">]</span><span class="operator">,</span> <span class="variable">n</span><span class="operator">++</span><span class="punctuation">]</span><span class="operator">;</span> <span class="variable">n</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">MaximalBy</span><span class="punctuation">[</span><span class="built_in">Flatten</span><span class="punctuation">[</span><span class="built_in">Table</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">a</span><span class="operator">,</span> <span class="variable">b</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">a</span><span class="operator">,</span> <span class="operator">-</span><span class="number">999</span><span class="operator">,</span> <span class="number">999</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">b</span><span class="operator">,</span> <span class="operator">-</span><span class="number">1000</span><span class="operator">,</span> <span class="number">1000</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="operator">,</span> <span class="number">1</span><span class="punctuation">]</span><span class="operator">,</span></span><br><span class="line">  <span class="variable">lengthOfQuadraticPrimes</span> <span class="operator">@@</span> <span class="type">#</span> <span class="operator">&amp;</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">First</span><span class="punctuation">[</span><span class="built_in">Times</span> <span class="operator">@@@</span> </span><br><span class="line">   <span class="built_in">TakeLargestBy</span><span class="punctuation">[</span></span><br><span class="line">    <span class="built_in">Cases</span><span class="punctuation">[</span><span class="built_in">Flatten</span><span class="punctuation">[</span></span><br><span class="line">      <span class="built_in">Table</span><span class="punctuation">[</span><span class="built_in">Table</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">a</span><span class="operator">,</span> <span class="variable">b</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">a</span><span class="operator">,</span> <span class="variable">sign1</span> <span class="built_in">Range</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">,</span> <span class="number">1000</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">b</span><span class="operator">,</span> </span><br><span class="line">         <span class="variable">sign2</span> <span class="built_in">Range</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">,</span> <span class="number">1000</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">sign1</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="operator">-</span><span class="number">1</span><span class="operator">,</span> <span class="number">1</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">sign2</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="operator">-</span><span class="number">1</span><span class="operator">,</span> <span class="number">1</span><span class="punctuation">&#125;</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="operator">,</span> </span><br><span class="line">      <span class="number">3</span><span class="punctuation">]</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="type">x_</span><span class="operator">,</span> <span class="type">y_</span><span class="punctuation">&#125;</span> <span class="operator">/;</span> <span class="variable">x</span> <span class="operator">&gt;</span> <span class="number">0</span> <span class="variable">\[Or]</span> <span class="variable">y</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="punctuation">]</span><span class="operator">,</span> </span><br><span class="line">    <span class="built_in">Function</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">a</span><span class="operator">,</span> <span class="variable">b</span><span class="punctuation">&#125;</span><span class="operator">,</span> </span><br><span class="line">       <span class="built_in">NestWhile</span><span class="punctuation">[</span><span class="type">#</span> <span class="operator">+</span> <span class="number">1</span> <span class="operator">&amp;,</span> <span class="number">0</span><span class="operator">,</span> <span class="built_in">PrimeQ</span><span class="punctuation">[</span><span class="type">#1</span><span class="operator">^</span><span class="number">2</span> <span class="operator">+</span> <span class="variable">a</span> <span class="type">#1</span> <span class="operator">+</span> <span class="variable">b</span><span class="punctuation">]</span> <span class="operator">&amp;</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">@@</span> <span class="type">#</span> <span class="operator">&amp;,</span> </span><br><span class="line">    <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">//</span> <span class="built_in">Timing</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-28"><a href="#Problem-28" class="headerlink" title="Problem 28"></a>Problem 28</h3><p>Starting with the number 1 and moving to the right in a clockwise direction a 5 by 5 spiral is formed as follows:</p>
<script type="math/tex; mode=display">
\begin{array}{rrrrr}
{\color{red}{21}} & 22 & 23 & 24 & {\color{red}{25}} \\
20 & {\color{red}{7}} & 8 & {\color{red}{9}} & 10 \\
19 & 6 & {\color{red}{1}} & 2 & 11 \\
18 & {\color{red}{5}} & 4 & {\color{red}{3}} & 12 \\
{\color{red}{17}} & 16 & 15 & 14 & {\color{red}{13}}
\end{array}</script><p>It can be verified that the sum of the numbers on the diagonals is $101$. What is the sum of the numbers on the diagonals in a 1001 by 1001 spiral formed in the same way?</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="operator">+</span> <span class="number">4</span> \<span class="operator">!</span>\<span class="punctuation">(</span></span><br><span class="line">\<span class="operator">*</span><span class="built_in">UnderoverscriptBox</span><span class="punctuation">[</span>\<span class="punctuation">(</span><span class="variable">\[Sum]</span>\<span class="punctuation">)</span><span class="operator">,</span> \<span class="punctuation">(</span><span class="variable">k</span> <span class="operator">=</span> <span class="number">1</span>\<span class="punctuation">)</span><span class="operator">,</span> \<span class="punctuation">(</span><span class="number">500</span>\<span class="punctuation">)</span><span class="punctuation">]</span>\<span class="punctuation">(</span><span class="punctuation">(</span></span><br><span class="line">\<span class="operator">*</span><span class="built_in">SuperscriptBox</span><span class="punctuation">[</span>\<span class="punctuation">(</span><span class="punctuation">(</span><span class="number">2</span>  <span class="variable">k</span> <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span>\<span class="punctuation">)</span><span class="operator">,</span> \<span class="punctuation">(</span><span class="number">2</span>\<span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">-</span> <span class="number">3</span>  <span class="variable">k</span><span class="punctuation">)</span>\<span class="punctuation">)</span>\<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-29"><a href="#Problem-29" class="headerlink" title="Problem 29"></a>Problem 29</h3><p>Consider all integer combinations of $a^b$ for $2 \leq a \leq 5$ and $2 \leq b \leq 5$:</p>
<script type="math/tex; mode=display">
\begin{aligned}
&2^2=4,2^3=8,2^4=16,2^5=32 \\
&3^2=9,3^3=27,3^4=81,3^5=243 \\
&4^2=16,4^3=64,4^4=256,4^5=1024 \\
&5^2=25,5^3=125,5^4=625,5^5=3125
\end{aligned}</script><p>If they are then placed in numerical order, with any repeats removed, we get the following sequence of $15$ distinct terms:</p>
<script type="math/tex; mode=display">
4,8,9,16,25,27,32,64,81,125,243,256,625,1024,3125</script><p>How many distinct terms are in the sequence generated by $a^b$ for $2 \leq a \leq 100$ and $2 \leq b \leq 100$?</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Length</span><span class="operator">@</span><span class="built_in">Union</span><span class="operator">@</span><span class="built_in">Flatten</span><span class="operator">@</span><span class="built_in">Table</span><span class="punctuation">[</span><span class="variable">a</span><span class="operator">^</span><span class="variable">b</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">a</span><span class="operator">,</span> <span class="number">2</span><span class="operator">,</span> <span class="number">100</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">b</span><span class="operator">,</span> <span class="number">2</span><span class="operator">,</span> <span class="number">100</span><span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-30"><a href="#Problem-30" class="headerlink" title="Problem 30"></a>Problem 30</h3><p>Surprisingly there are only three numbers that can be written as the sum of fourth powers of their digits:</p>
<script type="math/tex; mode=display">
\begin{aligned}
&1634=1^4+6^4+3^4+4^4 \\
&8208=8^4+2^4+0^4+8^4 \\
&9474=9^4+4^4+7^4+4^4
\end{aligned}</script><p>As $1=1^4$ is not a sum it is not included. The sum of these numbers is $1634+8208+9474=19316$. Find the sum of all the numbers that can be written as the sum of fifth powers of their digits.</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">n</span> <span class="operator">=</span> <span class="number">2</span><span class="operator">;</span> <span class="variable">res</span> <span class="operator">=</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="operator">;</span></span><br><span class="line"><span class="built_in">Dynamic</span><span class="punctuation">[</span><span class="variable">n</span><span class="punctuation">]</span></span><br><span class="line"><span class="built_in">While</span><span class="punctuation">[</span><span class="variable">n</span> <span class="operator">&lt;</span> <span class="number">999999</span><span class="operator">,</span> </span><br><span class="line">  <span class="built_in">If</span><span class="punctuation">[</span><span class="variable">n</span> <span class="operator">==</span> <span class="built_in">Total</span><span class="punctuation">[</span><span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">n</span><span class="punctuation">]</span><span class="operator">^</span><span class="number">5</span><span class="punctuation">]</span><span class="operator">,</span> <span class="built_in">AppendTo</span><span class="punctuation">[</span><span class="variable">res</span><span class="operator">,</span> <span class="variable">n</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">;</span> <span class="variable">n</span><span class="operator">++</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="punctuation">&#123;</span><span class="variable">res</span><span class="operator">,</span> <span class="built_in">Total</span><span class="punctuation">[</span><span class="variable">res</span><span class="punctuation">]</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-31"><a href="#Problem-31" class="headerlink" title="Problem 31"></a>Problem 31</h3><p>In the United Kingdom the currency is made up of pound $(£)$ and pence $(p)$. There are eight coins in general circulation:</p>
<script type="math/tex; mode=display">
1 p, 2 p, 5 p, 10 p, 20 p, 50 p, £ 1(100 p) \text {, and } £ 2 \text { (200p). }</script><p>It is possible to make $£ 2$ in the following way:</p>
<script type="math/tex; mode=display">
1 \times £ 1+1 \times 50 p+2 \times 20 p+1 \times 5 p+1 \times 2 p+3 \times 1 p</script><p>How many different ways can $£ 2$ be made using any number of coins?</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">count</span><span class="punctuation">[</span><span class="type">n_</span><span class="operator">,</span> <span class="type">lst__</span><span class="punctuation">]</span> <span class="operator">:=</span> <span class="built_in">Module</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">numoflast</span> <span class="operator">=</span> <span class="built_in">Floor</span><span class="punctuation">[</span><span class="variable">n</span><span class="operator">/</span><span class="variable">lst</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="operator">,</span></span><br><span class="line">   <span class="built_in">If</span><span class="punctuation">[</span><span class="variable">n</span> <span class="operator">==</span> <span class="number">0</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> </span><br><span class="line">    <span class="built_in">If</span><span class="punctuation">[</span><span class="built_in">Length</span><span class="punctuation">[</span><span class="variable">lst</span><span class="punctuation">]</span> <span class="operator">==</span> <span class="number">1</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> </span><br><span class="line">     <span class="built_in">Total</span><span class="punctuation">[</span><span class="built_in">Table</span><span class="punctuation">[</span></span><br><span class="line">       <span class="variable">count</span><span class="punctuation">[</span><span class="variable">n</span> <span class="operator">-</span> <span class="variable">k</span> <span class="variable">lst</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> <span class="built_in">Most</span><span class="punctuation">[</span><span class="variable">lst</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">k</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="variable">numoflast</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">count</span><span class="punctuation">[</span><span class="number">200</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="number">1</span><span class="operator">,</span> <span class="number">2</span><span class="operator">,</span> <span class="number">5</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">20</span><span class="operator">,</span> <span class="number">50</span><span class="operator">,</span> <span class="number">100</span><span class="operator">,</span> <span class="number">200</span><span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-32"><a href="#Problem-32" class="headerlink" title="Problem 32"></a>Problem 32</h3><p>We shall say that an $n$-digit number is pandigital if it makes use of all the digits $1$ to $n$ exactly once; for example, the $5$-digit number, $15234$, is $1$ through $5$ pandigital.</p>
<p>The product $7254$ is unusual, as the identity, $39 \times 186=7254$, containing multiplicand, multiplier, and product is $1$ through $9$ pandigital. Find the sum of all products whose multiplicand/multiplier/product identity can be written as a $1$ through $9$ pandigital.</p>
<p>HINT: Some products can be obtained in <strong>more than one way</strong> so be sure to only include it once in your sum.</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">alldigits</span> <span class="operator">=</span> <span class="built_in">Range</span><span class="punctuation">[</span><span class="number">9</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">lst</span> <span class="operator">=</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="operator">;</span></span><br><span class="line"><span class="punctuation">(</span><span class="variable">multiplicand</span> <span class="operator">=</span> <span class="type">#</span><span class="operator">;</span></span><br><span class="line">    <span class="built_in">If</span><span class="punctuation">[</span><span class="built_in">Length</span><span class="punctuation">[</span><span class="variable">multiplicand</span><span class="punctuation">]</span> <span class="operator">==</span> <span class="number">1</span><span class="operator">,</span></span><br><span class="line">     <span class="punctuation">(</span><span class="variable">multiplier</span> <span class="operator">=</span> <span class="type">#</span><span class="operator">;</span> </span><br><span class="line">        <span class="built_in">If</span><span class="punctuation">[</span><span class="built_in">Sort</span><span class="punctuation">[</span><span class="built_in">IntegerDigits</span><span class="punctuation">[</span></span><br><span class="line">            <span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="variable">multiplicand</span><span class="punctuation">]</span> <span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="variable">multiplier</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">==</span> </span><br><span class="line">          <span class="built_in">Sort</span><span class="punctuation">[</span><span class="built_in">Complement</span><span class="punctuation">[</span><span class="variable">alldigits</span><span class="operator">,</span> <span class="variable">multiplier</span><span class="operator">,</span> <span class="variable">multiplicand</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> </span><br><span class="line">         <span class="built_in">AppendTo</span><span class="punctuation">[</span></span><br><span class="line">          <span class="variable">lst</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="variable">multiplicand</span><span class="punctuation">]</span><span class="operator">,</span> <span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="variable">multiplier</span><span class="punctuation">]</span><span class="operator">,</span> </span><br><span class="line">           <span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="variable">multiplicand</span><span class="punctuation">]</span> <span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="variable">multiplier</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">&amp;</span> <span class="operator">/@</span> </span><br><span class="line">      <span class="built_in">Permutations</span><span class="punctuation">[</span><span class="built_in">Complement</span><span class="punctuation">[</span><span class="variable">alldigits</span><span class="operator">,</span> <span class="variable">multiplicand</span><span class="punctuation">]</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="number">4</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="operator">,</span></span><br><span class="line">     <span class="punctuation">(</span><span class="variable">multiplier</span> <span class="operator">=</span> <span class="type">#</span><span class="operator">;</span> </span><br><span class="line">        <span class="built_in">If</span><span class="punctuation">[</span><span class="built_in">Sort</span><span class="punctuation">[</span><span class="built_in">IntegerDigits</span><span class="punctuation">[</span></span><br><span class="line">            <span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="variable">multiplicand</span><span class="punctuation">]</span> <span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="variable">multiplier</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">==</span> </span><br><span class="line">          <span class="built_in">Sort</span><span class="punctuation">[</span><span class="built_in">Complement</span><span class="punctuation">[</span><span class="variable">alldigits</span><span class="operator">,</span> <span class="variable">multiplier</span><span class="operator">,</span> <span class="variable">multiplicand</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> </span><br><span class="line">         <span class="built_in">AppendTo</span><span class="punctuation">[</span></span><br><span class="line">          <span class="variable">lst</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="variable">multiplicand</span><span class="punctuation">]</span><span class="operator">,</span> <span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="variable">multiplier</span><span class="punctuation">]</span><span class="operator">,</span> </span><br><span class="line">           <span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="variable">multiplicand</span><span class="punctuation">]</span> <span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="variable">multiplier</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">&amp;</span> <span class="operator">/@</span> </span><br><span class="line">      <span class="built_in">Permutations</span><span class="punctuation">[</span><span class="built_in">Complement</span><span class="punctuation">[</span><span class="variable">alldigits</span><span class="operator">,</span> <span class="variable">multiplicand</span><span class="punctuation">]</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="number">3</span><span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br><span class="line">     <span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">&amp;</span> <span class="operator">/@</span> <span class="built_in">Permutations</span><span class="punctuation">[</span><span class="variable">alldigits</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="number">1</span><span class="operator">,</span> <span class="number">2</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">lst</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="built_in">All</span><span class="operator">,</span> <span class="number">3</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">//</span> <span class="built_in">Union</span> <span class="operator">//</span> <span class="built_in">Total</span></span><br></pre></td></tr></table></figure>
<p>其它结果</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">test</span> <span class="operator">=</span> <span class="built_in">MemberQ</span><span class="punctuation">[</span></span><br><span class="line">    <span class="built_in">Table</span><span class="punctuation">[</span><span class="built_in">Union</span> <span class="operator">@@</span> <span class="built_in">IntegerDigits</span><span class="operator">@</span><span class="type">#</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">i</span><span class="operator">,</span> <span class="operator">-</span><span class="variable">i</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">i</span><span class="operator">,</span> <span class="number">2</span><span class="operator">,</span> <span class="built_in">Length</span><span class="operator">@</span><span class="type">#</span><span class="operator">/</span><span class="number">2</span><span class="punctuation">&#125;</span><span class="punctuation">]</span> <span class="operator">&amp;</span><span class="punctuation">[</span></span><br><span class="line">     <span class="built_in">Divisors</span><span class="operator">@</span><span class="built_in">FromDigits</span><span class="operator">@</span><span class="type">#</span><span class="punctuation">]</span><span class="operator">,</span> <span class="built_in">Range</span><span class="operator">@</span><span class="number">9</span><span class="operator">~</span><span class="built_in">Complement</span><span class="operator">~</span><span class="type">#</span><span class="punctuation">]</span> <span class="operator">&amp;;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">FromDigits</span> <span class="operator">/@</span> <span class="built_in">Select</span><span class="punctuation">[</span><span class="built_in">Range</span><span class="operator">@</span><span class="number">9</span><span class="operator">~</span><span class="built_in">Permutations</span><span class="operator">~</span><span class="punctuation">&#123;</span><span class="number">4</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="variable">test</span><span class="punctuation">]</span> <span class="operator">//</span> <span class="built_in">Tr</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-33"><a href="#Problem-33" class="headerlink" title="Problem 33"></a>Problem 33</h3><p>The fraction $49 / 98$ is a curious fraction, as an inexperienced mathematician in attempting to simplify it may incorrectly believe that $49 / 98=4 / 8$, which is correct, is obtained by cancelling the $9$s.</p>
<p>We shall consider fractions like, $30 / 50=3 / 5$, to be trivial examples.</p>
<p>There are exactly four non-trivial examples of this type of fraction, less than one in value, and containing two digits in the numerator and denominator.</p>
<p>If the product of these four fractions is given in its lowest common terms, find the value of the denominator.</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">test</span><span class="punctuation">[</span><span class="type">mn__</span><span class="punctuation">]</span> <span class="operator">:=</span> </span><br><span class="line">  <span class="built_in">Module</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">commonDigits</span> <span class="operator">=</span> </span><br><span class="line">     <span class="built_in">Intersection</span><span class="punctuation">[</span><span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">mn</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> <span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">mn</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> </span><br><span class="line">    <span class="variable">m</span> <span class="operator">=</span> <span class="variable">mn</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> <span class="variable">n</span> <span class="operator">=</span> <span class="variable">mn</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="operator">,</span> </span><br><span class="line">   <span class="built_in">If</span><span class="punctuation">[</span><span class="built_in">Length</span><span class="punctuation">[</span><span class="variable">commonDigits</span><span class="punctuation">]</span> <span class="operator">==</span> <span class="number">1</span> <span class="operator">&amp;&amp;</span> <span class="variable">commonDigits</span> <span class="operator">!=</span> <span class="punctuation">&#123;</span><span class="number">0</span><span class="punctuation">&#125;</span> <span class="operator">&amp;&amp;</span> </span><br><span class="line">     <span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="built_in">Complement</span><span class="punctuation">[</span><span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">n</span><span class="punctuation">]</span><span class="operator">,</span> <span class="variable">commonDigits</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">!=</span> <span class="number">0</span><span class="operator">,</span> </span><br><span class="line">    <span class="variable">m</span><span class="operator">/</span><span class="variable">n</span> <span class="operator">==</span> <span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="built_in">Complement</span><span class="punctuation">[</span><span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">m</span><span class="punctuation">]</span><span class="operator">,</span> <span class="variable">commonDigits</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">/</span></span><br><span class="line">     <span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="built_in">Complement</span><span class="punctuation">[</span><span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">n</span><span class="punctuation">]</span><span class="operator">,</span> <span class="variable">commonDigits</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> <span class="built_in">False</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">   <span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">res</span> <span class="operator">=</span> <span class="built_in">Select</span><span class="punctuation">[</span><span class="built_in">Flatten</span><span class="punctuation">[</span><span class="built_in">Table</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">m</span><span class="operator">,</span> <span class="variable">n</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">m</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">99</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">n</span><span class="operator">,</span> <span class="variable">m</span> <span class="operator">+</span> <span class="number">1</span><span class="operator">,</span> <span class="number">99</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="operator">,</span> <span class="number">1</span><span class="punctuation">]</span><span class="operator">,</span> </span><br><span class="line">   <span class="variable">test</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="built_in">Times</span> <span class="operator">@@</span> <span class="punctuation">(</span><span class="type">#</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">/</span><span class="type">#</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">&amp;</span> <span class="operator">/@</span> <span class="variable">res</span><span class="punctuation">)</span> <span class="operator">//</span> <span class="built_in">Denominator</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-34"><a href="#Problem-34" class="headerlink" title="Problem 34"></a>Problem 34</h3><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">test</span><span class="punctuation">[</span><span class="type">n_</span><span class="punctuation">]</span> <span class="operator">:=</span> <span class="built_in">Plus</span> <span class="operator">@@</span> <span class="punctuation">(</span><span class="built_in">Factorial</span><span class="punctuation">[</span><span class="type">#</span><span class="punctuation">]</span> <span class="operator">&amp;</span> <span class="operator">/@</span> <span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">n</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">==</span> <span class="variable">n</span><span class="operator">;</span></span><br><span class="line"><span class="built_in">Total</span><span class="punctuation">[</span><span class="built_in">Select</span><span class="punctuation">[</span><span class="built_in">Range</span><span class="punctuation">[</span><span class="number">100000</span><span class="punctuation">]</span><span class="operator">,</span> <span class="variable">test</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">-</span> <span class="number">3</span> <span class="operator">//</span> <span class="built_in">Timing</span></span><br></pre></td></tr></table></figure>
<p>其它解法</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Sum</span><span class="punctuation">[</span><span class="built_in">Boole</span><span class="punctuation">[</span><span class="variable">n</span> <span class="operator">==</span> <span class="built_in">Tr</span><span class="punctuation">[</span><span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">n</span><span class="punctuation">]</span><span class="operator">!</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="variable">n</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">n</span><span class="operator">,</span> <span class="number">3</span><span class="operator">,</span> <span class="number">1*^5</span><span class="punctuation">&#125;</span><span class="punctuation">]</span> <span class="operator">//</span> <span class="built_in">Timing</span></span><br></pre></td></tr></table></figure>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Total</span><span class="operator">@</span><span class="punctuation">(</span><span class="built_in">Transpose</span><span class="operator">@</span></span><br><span class="line">     <span class="built_in">Select</span><span class="punctuation">[</span><span class="built_in">Transpose</span><span class="operator">@</span><span class="punctuation">&#123;</span><span class="built_in">MapIndexed</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="built_in">Total</span><span class="punctuation">[</span><span class="type">#1</span><span class="punctuation">]</span><span class="punctuation">&#125;</span> <span class="operator">==</span> <span class="type">#2</span> <span class="operator">+</span> <span class="number">9</span> <span class="operator">&amp;,</span> </span><br><span class="line">         <span class="built_in">Map</span><span class="punctuation">[</span><span class="built_in">Factorial</span><span class="operator">,</span> <span class="type">#</span><span class="punctuation">]</span> <span class="operator">&amp;</span> <span class="operator">/@</span> <span class="built_in">IntegerDigits</span> <span class="operator">/@</span> <span class="built_in">Range</span><span class="punctuation">[</span><span class="number">10</span><span class="operator">,</span> <span class="number">100000</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> </span><br><span class="line">        <span class="built_in">Range</span><span class="punctuation">[</span><span class="number">10</span><span class="operator">,</span> <span class="number">100000</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="type">#</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">&amp;</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">//</span> <span class="built_in">Timing</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-35"><a href="#Problem-35" class="headerlink" title="Problem 35"></a>Problem 35</h3><p>The number, $197$, is called a circular prime because all rotations of the digits: $197, 971$, and $719$, are themselves prime. There are thirteen such primes below $100: 2,3,5,7,11,13,17,31,37,71,73,79$, and $97$. How many circular primes are there below one million?</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">test</span><span class="punctuation">[</span><span class="type">num_</span><span class="punctuation">]</span> <span class="operator">:=</span> </span><br><span class="line">  <span class="built_in">And</span> <span class="operator">@@</span> <span class="punctuation">(</span><span class="built_in">PrimeQ</span><span class="punctuation">[</span><span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="built_in">RotateLeft</span><span class="punctuation">[</span><span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">num</span><span class="punctuation">]</span><span class="operator">,</span> <span class="type">#</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">&amp;</span> <span class="operator">/@</span> </span><br><span class="line">     <span class="built_in">Range</span><span class="punctuation">[</span><span class="built_in">Length</span><span class="punctuation">[</span><span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">num</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="operator">;</span></span><br><span class="line"><span class="variable">res</span> <span class="operator">=</span> <span class="built_in">Select</span><span class="punctuation">[</span><span class="built_in">Prime</span><span class="punctuation">[</span><span class="built_in">Range</span><span class="punctuation">[</span><span class="built_in">PrimePi</span><span class="punctuation">[</span><span class="number">1000000</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> <span class="variable">test</span><span class="punctuation">]</span></span><br><span class="line"><span class="built_in">Length</span><span class="punctuation">[</span><span class="variable">res</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-36"><a href="#Problem-36" class="headerlink" title="Problem 36"></a>Problem 36</h3><p>The decimal number, $585=1001001001_2$ (binary), is palindromic in both bases. Find the sum of all numbers, less than one million, which are palindromic in base $10$ and base $2$. (Please note that the palindromic number, in either base, may not include leading zeros.)</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">test</span><span class="punctuation">[</span><span class="type">n_</span><span class="punctuation">]</span> <span class="operator">:=</span> <span class="punctuation">(</span><span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">n</span><span class="punctuation">]</span> <span class="operator">==</span> </span><br><span class="line">     <span class="built_in">Reverse</span><span class="punctuation">[</span><span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">n</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">&amp;&amp;</span> <span class="punctuation">(</span><span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">n</span><span class="operator">,</span> <span class="number">2</span><span class="punctuation">]</span> <span class="operator">==</span> </span><br><span class="line">     <span class="built_in">Reverse</span><span class="punctuation">[</span><span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">n</span><span class="operator">,</span> <span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="operator">;</span></span><br><span class="line"><span class="variable">res</span> <span class="operator">=</span> <span class="built_in">Select</span><span class="punctuation">[</span><span class="built_in">Range</span><span class="punctuation">[</span><span class="number">1000000</span><span class="punctuation">]</span><span class="operator">,</span> <span class="variable">test</span><span class="punctuation">]</span></span><br><span class="line"><span class="built_in">Total</span><span class="punctuation">[</span><span class="variable">res</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-37"><a href="#Problem-37" class="headerlink" title="Problem 37"></a>Problem 37</h3><p>The number $3797$ has an interesting property. Being prime itself, it is possible to continuously remove digits from left to right, and remain prime at each stage: $3797,797,97$, and $7$. Similarly we can work from right to left: $3797,379,37$, and $3$.</p>
<p>Find the sum of the only eleven primes that are both truncatable from left to right and right to left.</p>
<p>NOTE: $2,3,5$, and $7$ are not considered to be truncatable primes.</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">primes</span> <span class="operator">=</span> <span class="built_in">Table</span><span class="punctuation">[</span><span class="built_in">Prime</span><span class="punctuation">[</span><span class="variable">n</span><span class="punctuation">]</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">n</span><span class="operator">,</span> <span class="number">5</span><span class="operator">,</span> <span class="number">1000000</span><span class="operator">/</span><span class="built_in">Log</span><span class="punctuation">[</span><span class="number">1000000</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="built_in">ClearAll</span><span class="punctuation">[</span><span class="variable">TruncateLeft</span><span class="operator">,</span> <span class="variable">TruncateRight</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">TruncateRight</span><span class="punctuation">[</span><span class="type">num_</span><span class="punctuation">]</span> <span class="operator">:=</span> <span class="built_in">Module</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">numberdigits</span> <span class="operator">=</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="variable">primeq</span><span class="punctuation">&#125;</span><span class="operator">,</span></span><br><span class="line">   <span class="variable">numberdigits</span> <span class="operator">=</span> <span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">num</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line">   <span class="variable">primeq</span> <span class="operator">=</span> </span><br><span class="line">    <span class="built_in">PrimeQ</span><span class="punctuation">[</span><span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="type">#</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">&amp;</span> <span class="operator">/@</span> <span class="punctuation">(</span><span class="built_in">NestList</span><span class="punctuation">[</span><span class="built_in">Most</span><span class="operator">,</span> <span class="variable">numberdigits</span><span class="operator">,</span> </span><br><span class="line">       <span class="built_in">Length</span><span class="operator">@</span><span class="variable">numberdigits</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="operator">;</span></span><br><span class="line">   <span class="built_in">And</span> <span class="operator">@@</span> <span class="variable">primeq</span></span><br><span class="line">   <span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">TruncateLeft</span><span class="punctuation">[</span><span class="type">num_</span><span class="punctuation">]</span> <span class="operator">:=</span> <span class="built_in">Module</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">numberdigits</span> <span class="operator">=</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="variable">primeq</span><span class="punctuation">&#125;</span><span class="operator">,</span></span><br><span class="line">   <span class="variable">numberdigits</span> <span class="operator">=</span> <span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="variable">num</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line">   <span class="variable">primeq</span> <span class="operator">=</span> </span><br><span class="line">    <span class="built_in">PrimeQ</span><span class="punctuation">[</span><span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="type">#</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">&amp;</span> <span class="operator">/@</span> <span class="punctuation">(</span><span class="built_in">NestList</span><span class="punctuation">[</span><span class="built_in">Rest</span><span class="operator">,</span> <span class="variable">numberdigits</span><span class="operator">,</span> </span><br><span class="line">       <span class="built_in">Length</span><span class="operator">@</span><span class="variable">numberdigits</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="operator">;</span></span><br><span class="line">   <span class="built_in">And</span> <span class="operator">@@</span> <span class="variable">primeq</span></span><br><span class="line">   <span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">res</span> <span class="operator">=</span> <span class="built_in">Select</span><span class="punctuation">[</span><span class="punctuation">(</span><span class="punctuation">&#123;</span><span class="type">#</span><span class="operator">,</span> <span class="variable">TruncateLeft</span><span class="operator">@</span><span class="type">#</span><span class="operator">,</span> <span class="variable">TruncateRight</span><span class="operator">@</span><span class="type">#</span><span class="punctuation">&#125;</span><span class="punctuation">)</span> <span class="operator">&amp;</span> <span class="operator">/@</span> </span><br><span class="line">    <span class="variable">primes</span><span class="operator">,</span> <span class="type">#</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">&amp;&amp;</span> <span class="type">#</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">&amp;</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="built_in">Total</span><span class="punctuation">[</span><span class="variable">res</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="built_in">All</span><span class="operator">,</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<p>其他解法</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">f</span><span class="punctuation">[</span><span class="type">a_</span><span class="operator">,</span> <span class="type">b_</span><span class="punctuation">]</span> <span class="operator">:=</span> <span class="built_in">Select</span><span class="punctuation">[</span><span class="built_in">Plus</span> <span class="operator">@@@</span> <span class="built_in">Tuples</span><span class="operator">@</span><span class="punctuation">&#123;</span><span class="type">#</span> <span class="variable">a</span><span class="operator">,</span> <span class="variable">b</span><span class="operator">^</span><span class="type">#2</span> <span class="built_in">Range</span><span class="operator">@</span><span class="number">9</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="built_in">PrimeQ</span><span class="punctuation">]</span> <span class="operator">&amp;</span></span><br><span class="line"><span class="variable">g</span><span class="punctuation">[</span><span class="type">x__</span><span class="operator">,</span> <span class="type">n_</span><span class="punctuation">]</span> <span class="operator">:=</span> <span class="built_in">Join</span> <span class="operator">@@</span> <span class="built_in">FoldList</span><span class="punctuation">[</span><span class="variable">f</span><span class="operator">@</span><span class="variable">x</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="number">0</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="number">0</span><span class="operator">~</span><span class="built_in">Range</span><span class="operator">~</span><span class="variable">n</span><span class="punctuation">]</span><span class="operator">~</span><span class="built_in">Drop</span><span class="operator">~</span><span class="number">2</span></span><br><span class="line"><span class="variable">g</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">,</span> <span class="number">10</span><span class="operator">,</span> <span class="number">5</span><span class="punctuation">]</span> <span class="variable">\[Intersection]</span> <span class="variable">g</span><span class="punctuation">[</span><span class="number">10</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="number">5</span><span class="punctuation">]</span> <span class="operator">//</span> <span class="built_in">Tr</span></span><br></pre></td></tr></table></figure>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Total</span><span class="punctuation">[</span><span class="built_in">Intersection</span><span class="punctuation">[</span></span><br><span class="line">   <span class="built_in">Flatten</span><span class="punctuation">[</span><span class="built_in">NestWhileList</span><span class="punctuation">[</span></span><br><span class="line">     <span class="built_in">Select</span><span class="punctuation">[</span><span class="built_in">Flatten</span><span class="punctuation">[</span></span><br><span class="line">        <span class="built_in">Table</span><span class="punctuation">[</span><span class="number">10</span> <span class="type">#</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="variable">i</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">+</span> <span class="variable">j</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">i</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="built_in">Length</span><span class="punctuation">[</span><span class="type">#</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">j</span><span class="operator">,</span> <span class="number">0</span><span class="operator">,</span> <span class="number">9</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> </span><br><span class="line">       <span class="built_in">PrimeQ</span><span class="punctuation">]</span> <span class="operator">&amp;,</span> <span class="punctuation">&#123;</span><span class="number">0</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="type">#</span> <span class="operator">!=</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span> <span class="operator">&amp;</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> </span><br><span class="line">   <span class="built_in">Flatten</span><span class="punctuation">[</span><span class="built_in">NestWhileList</span><span class="punctuation">[</span></span><br><span class="line">     <span class="built_in">Select</span><span class="punctuation">[</span><span class="built_in">Flatten</span><span class="punctuation">[</span></span><br><span class="line">        <span class="built_in">Table</span><span class="punctuation">[</span><span class="type">#</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="variable">i</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">+</span> <span class="number">10</span><span class="operator">^</span><span class="punctuation">(</span><span class="number">1</span> <span class="operator">+</span> <span class="built_in">Floor</span><span class="punctuation">[</span><span class="built_in">Log</span><span class="punctuation">[</span><span class="number">10</span><span class="operator">,</span> <span class="type">#</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="variable">i</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="operator">*</span><span class="variable">j</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">i</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> </span><br><span class="line">          <span class="built_in">Length</span><span class="punctuation">[</span><span class="type">#</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">j</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="number">9</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> <span class="built_in">PrimeQ</span><span class="punctuation">]</span> <span class="operator">&amp;,</span> <span class="punctuation">&#123;</span><span class="number">2</span><span class="operator">,</span> <span class="number">3</span><span class="operator">,</span> <span class="number">5</span><span class="operator">,</span> </span><br><span class="line">      <span class="number">7</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="type">#</span> <span class="operator">!=</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span> <span class="operator">&amp;</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">-</span> <span class="built_in">Total</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="number">2</span><span class="operator">,</span> <span class="number">3</span><span class="operator">,</span> <span class="number">5</span><span class="operator">,</span> <span class="number">7</span><span class="punctuation">&#125;</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-38"><a href="#Problem-38" class="headerlink" title="Problem 38"></a>Problem 38</h3><p>Take the number $192$ and multiply it by each of $1, 2$, and $3$:</p>
<script type="math/tex; mode=display">
\begin{aligned}
& 192 \times 1=192 \\
& 192 \times 2=384 \\
& 192 \times 3=576
\end{aligned}</script><p>By concatenating each product we get the $1$ to $9$ pandigital, $192384576$. We will call $192384576$ the concatenated product of $192$ and $(1,2,3)$.</p>
<p>The same can be achieved by starting with $9$ and multiplying by $1,2,3,4$, and $5$, giving the pandigital, $918273645$, which is the concatenated product of $9$ and $(1,2,3,4,5)$.</p>
<p>What is the largest $1$ to $9$ pandigital $9$-digit number that can be formed as the concatenated product of an integer with $(1,2, \ldots, n)$ where $n&gt;1$?</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">test</span><span class="punctuation">[</span><span class="type">num_</span><span class="punctuation">]</span> <span class="operator">:=</span> <span class="built_in">Module</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">digitslength</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">,</span> <span class="variable">n</span> <span class="operator">=</span> <span class="number">0</span><span class="operator">,</span> <span class="variable">products</span><span class="punctuation">&#125;</span><span class="operator">,</span></span><br><span class="line">   <span class="variable">digitslength</span> <span class="operator">=</span> <span class="built_in">Length</span><span class="operator">@</span><span class="built_in">IntegerDigits</span><span class="operator">@</span><span class="variable">num</span><span class="operator">;</span></span><br><span class="line">   <span class="variable">n</span> <span class="operator">=</span> <span class="built_in">Quotient</span><span class="punctuation">[</span><span class="number">9</span><span class="operator">,</span> <span class="variable">digitslength</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line">   <span class="variable">products</span> <span class="operator">=</span> <span class="built_in">Table</span><span class="punctuation">[</span><span class="variable">num</span> <span class="variable">k</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">k</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="variable">n</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line">   <span class="built_in">Join</span> <span class="operator">@@</span> <span class="punctuation">(</span><span class="built_in">IntegerDigits</span> <span class="operator">/@</span> <span class="variable">products</span><span class="punctuation">)</span></span><br><span class="line">   <span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">res</span> <span class="operator">=</span> <span class="built_in">Select</span><span class="punctuation">[</span><span class="built_in">Range</span><span class="punctuation">[</span><span class="number">10000</span><span class="punctuation">]</span><span class="operator">,</span> <span class="built_in">Sort</span><span class="punctuation">[</span><span class="variable">test</span><span class="punctuation">[</span><span class="type">#</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">==</span> <span class="built_in">Range</span><span class="punctuation">[</span><span class="number">9</span><span class="punctuation">]</span> <span class="operator">&amp;</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="built_in">Max</span><span class="punctuation">[</span><span class="built_in">FromDigits</span> <span class="operator">/@</span> <span class="punctuation">(</span><span class="variable">test</span> <span class="operator">/@</span> <span class="variable">res</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<p>其他解法</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">f</span> <span class="operator">=</span> <span class="built_in">Join</span> <span class="operator">@@</span> <span class="built_in">IntegerDigits</span><span class="punctuation">[</span><span class="type">#</span> <span class="punctuation">&#123;</span><span class="number">1</span><span class="operator">,</span> <span class="number">2</span><span class="punctuation">&#125;</span><span class="punctuation">]</span> <span class="operator">&amp;;</span></span><br><span class="line"><span class="built_in">For</span><span class="punctuation">[</span><span class="variable">n</span> <span class="operator">=</span> <span class="number">1*^4</span><span class="operator">,</span> <span class="built_in">Union</span><span class="operator">@</span><span class="variable">f</span><span class="operator">@</span><span class="variable">n</span> <span class="operator">=!=</span> <span class="built_in">Range</span><span class="operator">@</span><span class="number">9</span><span class="operator">,</span> <span class="variable">n</span><span class="operator">--</span><span class="punctuation">]</span><span class="operator">;</span> <span class="built_in">Row</span><span class="operator">@</span><span class="variable">f</span><span class="operator">@</span><span class="variable">n</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-39"><a href="#Problem-39" class="headerlink" title="Problem 39"></a>Problem 39</h3><p>If $p$ is the perimeter of a right angle triangle with integral length sides, $\{a, b, c\}$, there are exactly three solutions for $p=120$. $\{20,48,52\},\{24,45,51\},\{30,40,50\}$.</p>
<p>For which value of $p \le 1000$, is the number of solutions maximised?</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">pairs</span> <span class="operator">=</span> <span class="built_in">Flatten</span><span class="punctuation">[</span></span><br><span class="line">   <span class="built_in">Table</span><span class="punctuation">[</span><span class="variable">k</span> <span class="built_in">Join</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="number">2</span> <span class="variable">m</span> <span class="punctuation">(</span><span class="variable">m</span> <span class="operator">+</span> <span class="variable">n</span><span class="punctuation">)</span><span class="punctuation">&#125;</span><span class="operator">,</span> </span><br><span class="line">      <span class="built_in">Sort</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">m</span><span class="operator">^</span><span class="number">2</span> <span class="operator">-</span> <span class="variable">n</span><span class="operator">^</span><span class="number">2</span><span class="operator">,</span> <span class="number">2</span> <span class="variable">m</span> <span class="variable">n</span><span class="operator">,</span> <span class="variable">m</span><span class="operator">^</span><span class="number">2</span> <span class="operator">+</span> <span class="variable">n</span><span class="operator">^</span><span class="number">2</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">n</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="number">31</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">m</span><span class="operator">,</span> <span class="variable">n</span> <span class="operator">+</span> <span class="number">1</span><span class="operator">,</span> </span><br><span class="line">     <span class="number">31</span><span class="punctuation">&#125;</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">k</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="built_in">Floor</span><span class="punctuation">[</span><span class="number">1000</span><span class="operator">/</span><span class="punctuation">(</span><span class="number">2</span> <span class="variable">m</span> <span class="punctuation">(</span><span class="variable">m</span> <span class="operator">+</span> <span class="variable">n</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="operator">,</span> <span class="number">2</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">correctpaires</span> <span class="operator">=</span> <span class="built_in">Union</span><span class="operator">@</span><span class="built_in">Select</span><span class="punctuation">[</span><span class="variable">pairs</span><span class="operator">,</span> <span class="type">#</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">&lt;=</span> <span class="number">1000</span> <span class="operator">&amp;</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">gatheredpaires</span> <span class="operator">=</span> <span class="built_in">GatherBy</span><span class="punctuation">[</span><span class="variable">correctpaires</span><span class="operator">,</span> <span class="built_in">First</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">maxLength</span> <span class="operator">=</span> <span class="built_in">Max</span><span class="punctuation">[</span><span class="built_in">Length</span> <span class="operator">/@</span> <span class="variable">gatheredpaires</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="built_in">Select</span><span class="punctuation">[</span><span class="variable">gatheredpaires</span><span class="operator">,</span> <span class="built_in">Length</span><span class="operator">@</span><span class="type">#</span> <span class="operator">==</span> <span class="variable">maxLength</span> <span class="operator">&amp;</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-40"><a href="#Problem-40" class="headerlink" title="Problem 40"></a>Problem 40</h3><p>An irrational decimal fraction is created by concatenating the positive integers:</p>
<script type="math/tex; mode=display">
0.12345678910{\color{red}{1}}112131415161718192021 \cdots</script><p>It can be seen that the $12$-th digit of the fractional part is $1$.<br>If $d_n$ represents the $n$-th digit of the fractional part, find the value of the following expression.</p>
<script type="math/tex; mode=display">
d_1 \times d_{10} \times d_{100} \times d_{1000} \times d_{10000} \times d_{100000} \times d_{1000000}.</script><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">lst</span> <span class="operator">=</span> <span class="built_in">Join</span> <span class="operator">@@</span> <span class="punctuation">(</span><span class="built_in">IntegerDigits</span> <span class="operator">/@</span> <span class="built_in">Range</span><span class="punctuation">[</span><span class="number">1000000</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="operator">;</span></span><br><span class="line"><span class="variable">lst</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="variable">lst</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="variable">lst</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">100</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="variable">lst</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">1000</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="variable">lst</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">10000</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="variable">lst</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">100000</span><span class="punctuation">]</span><span class="punctuation">]</span> \</span><br><span class="line"><span class="variable">lst</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">1000000</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<p>其他解法</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">ChampernowneDigit</span><span class="punctuation">[</span><span class="type">n_</span><span class="punctuation">]</span> <span class="operator">:=</span> <span class="built_in">Block</span><span class="punctuation">[</span><span class="punctuation">&#123;</span><span class="variable">m</span> <span class="operator">=</span> <span class="variable">n</span><span class="punctuation">&#125;</span><span class="operator">,</span></span><br><span class="line">   <span class="built_in">For</span><span class="punctuation">[</span><span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span><span class="operator">,</span> <span class="number">9</span><span class="operator">*</span><span class="punctuation">(</span><span class="number">10</span><span class="operator">^</span><span class="punctuation">(</span><span class="variable">i</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="variable">i</span> <span class="operator">&lt;</span> <span class="variable">m</span><span class="operator">,</span> <span class="variable">i</span><span class="operator">++,</span> <span class="variable">m</span> <span class="operator">-=</span> <span class="number">9</span><span class="operator">*</span><span class="punctuation">(</span><span class="number">10</span><span class="operator">^</span><span class="punctuation">(</span><span class="variable">i</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="variable">i</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line">   <span class="built_in">IntegerDigits</span><span class="punctuation">[</span></span><br><span class="line">     <span class="built_in">Floor</span><span class="punctuation">[</span><span class="punctuation">(</span><span class="variable">m</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="operator">/</span><span class="variable">i</span><span class="punctuation">]</span> <span class="operator">+</span> <span class="number">10</span><span class="operator">^</span><span class="punctuation">(</span><span class="variable">i</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="variable">m</span> <span class="operator">-</span> <span class="variable">i</span> <span class="built_in">Floor</span><span class="punctuation">[</span><span class="punctuation">(</span><span class="variable">m</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="operator">/</span><span class="variable">i</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line">   <span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="built_in">Times</span> <span class="operator">@@</span> <span class="punctuation">(</span><span class="variable">ChampernowneDigit</span> <span class="operator">/@</span> <span class="punctuation">(</span><span class="number">10</span><span class="operator">^</span><span class="built_in">Range</span><span class="punctuation">[</span><span class="number">0</span><span class="operator">,</span> <span class="number">6</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p>一行代码的 bruteforce 解决<br><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Times</span> <span class="operator">@@</span> <span class="built_in">Flatten</span><span class="punctuation">[</span><span class="built_in">IntegerDigits</span><span class="operator">@</span><span class="built_in">Range</span><span class="operator">@</span><span class="number">2*^5</span><span class="punctuation">]</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">10</span><span class="operator">^</span><span class="built_in">Range</span><span class="operator">@</span><span class="number">6</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Problem-41"><a href="#Problem-41" class="headerlink" title="Problem 41"></a>Problem 41</h3><p>We shall say that an $n$-digit number is pandigital if it makes use of all the digits $1$ to $n$ exactly once. For example, $2143$ is a $4$-digit pandigital and is also prime.</p>
<p>What is the largest $n$-digit pandigital prime that exists?</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">For</span><span class="punctuation">[</span><span class="variable">n</span> <span class="operator">=</span> <span class="number">9</span><span class="operator">,</span> <span class="punctuation">(</span><span class="variable">lst</span> <span class="operator">=</span> </span><br><span class="line">     <span class="built_in">Select</span><span class="punctuation">[</span><span class="built_in">Permutations</span><span class="punctuation">[</span><span class="built_in">Range</span><span class="punctuation">[</span><span class="variable">n</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">,</span> <span class="built_in">PrimeQ</span><span class="punctuation">[</span><span class="built_in">FromDigits</span><span class="punctuation">[</span><span class="type">#</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">&amp;</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">==</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="operator">,</span> </span><br><span class="line">  <span class="variable">n</span><span class="operator">--</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="built_in">Print</span><span class="punctuation">[</span><span class="built_in">Max</span><span class="punctuation">[</span><span class="built_in">FromDigits</span> <span class="operator">/@</span> <span class="variable">lst</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<p>其他解法</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Select</span><span class="punctuation">[</span><span class="built_in">FromDigits</span><span class="operator">/@</span><span class="built_in">Permutations</span><span class="operator">@</span><span class="built_in">Range</span><span class="operator">@</span><span class="type">#</span><span class="operator">,</span><span class="built_in">PrimeQ</span><span class="punctuation">]</span><span class="operator">&amp;~</span><span class="built_in">Array</span><span class="operator">~</span><span class="number">9</span><span class="operator">//</span><span class="built_in">Max</span></span><br></pre></td></tr></table></figure>
<h3 id="Problem-42"><a href="#Problem-42" class="headerlink" title="Problem 42"></a>Problem 42</h3><p>The $n$-th term of the sequence of triangle numbers is given by, $t_n=\frac{1}{2} n(n+1)$; so the first ten triangle numbers are:</p>
<script type="math/tex; mode=display">
1,3,6,10,15,21,28,36,45,55, \cdots</script><p>By converting each letter in a word to a number corresponding to its alphabetical position and adding these values we form a word value. For example, the word value for SKY is $19+11+25=55=t_{10}$. If the word value is a triangle number then we shall call the word a triangle word.</p>
<p>Using <a target="_blank" rel="noopener" href="https://projecteuler.net/resources/documents/0042_words.txt">words.txt</a> (right click and ‘Save Link/Target As…’), a 16K text file containing nearly two-thousand common English words, how many are triangle words?</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">olddata</span> <span class="operator">=</span> </span><br><span class="line">  <span class="built_in">Import</span><span class="punctuation">[</span><span class="string">&quot;https://projecteuler.net/resources/documents/0042_words.\</span></span><br><span class="line"><span class="string">txt&quot;</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">newdata</span> <span class="operator">=</span> <span class="built_in">StringSplit</span><span class="punctuation">[</span><span class="built_in">StringReplace</span><span class="punctuation">[</span><span class="variable">olddata</span><span class="operator">,</span> <span class="string">&quot;\&quot;&quot;</span> <span class="operator">-&gt;</span> <span class="string">&quot;&quot;</span><span class="punctuation">]</span><span class="operator">,</span> <span class="string">&quot;,&quot;</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="variable">TriangleNumber</span><span class="punctuation">[</span><span class="type">n_</span><span class="punctuation">]</span> <span class="operator">:=</span> <span class="punctuation">(</span><span class="variable">n</span> <span class="punctuation">(</span><span class="variable">n</span> <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">/</span><span class="number">2</span><span class="operator">;</span></span><br><span class="line"><span class="variable">wordvalue</span> <span class="operator">=</span> <span class="built_in">Total</span> <span class="operator">/@</span> <span class="punctuation">(</span><span class="built_in">Characters</span><span class="punctuation">[</span><span class="variable">newdata</span><span class="punctuation">]</span> <span class="operator">//</span> <span class="built_in">LetterNumber</span><span class="punctuation">)</span><span class="operator">;</span></span><br><span class="line"><span class="variable">m</span> <span class="operator">=</span> <span class="built_in">Max</span><span class="punctuation">[</span><span class="variable">wordvalue</span><span class="punctuation">]</span><span class="operator">;</span></span><br><span class="line"><span class="built_in">Select</span><span class="punctuation">[</span><span class="built_in">Total</span> <span class="operator">/@</span> <span class="punctuation">(</span><span class="built_in">Characters</span><span class="punctuation">[</span><span class="variable">newdata</span><span class="punctuation">]</span> <span class="operator">//</span> <span class="built_in">LetterNumber</span><span class="punctuation">)</span><span class="operator">,</span> </span><br><span class="line">  <span class="built_in">MemberQ</span><span class="punctuation">[</span><span class="built_in">Table</span><span class="punctuation">[</span></span><br><span class="line">     <span class="variable">TriangleNumber</span><span class="punctuation">[</span><span class="variable">n</span><span class="punctuation">]</span><span class="operator">,</span> <span class="punctuation">&#123;</span><span class="variable">n</span><span class="operator">,</span> <span class="number">1</span><span class="operator">,</span> <span class="number">1</span> <span class="operator">+</span> <span class="built_in">Floor</span><span class="punctuation">[</span><span class="built_in">Sqrt</span><span class="punctuation">[</span><span class="number">2</span> <span class="variable">m</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="punctuation">]</span><span class="operator">,</span> <span class="type">#</span><span class="punctuation">]</span> <span class="operator">&amp;</span><span class="punctuation">]</span> <span class="operator">//</span> <span class="built_in">Length</span></span><br></pre></td></tr></table></figure>
<p>其他解答<br><figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">codes</span> <span class="operator">=</span> <span class="built_in">ToCharacterCode</span><span class="operator">@</span><span class="built_in">Import</span><span class="punctuation">[</span><span class="string">&quot;Y:\\tmp\\0042_words.csv&quot;</span><span class="punctuation">]</span><span class="punctuation">[</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">-</span> <span class="number">64</span><span class="operator">;</span></span><br><span class="line"><span class="built_in">Sqrt</span><span class="punctuation">[</span><span class="number">1</span> <span class="operator">+</span> <span class="number">8</span> <span class="built_in">Tr</span> <span class="operator">/@</span> <span class="variable">codes</span><span class="punctuation">]</span><span class="operator">~</span><span class="built_in">Count</span><span class="operator">~_</span><span class="built_in">Integer</span></span><br></pre></td></tr></table></figure></p>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Larry Eppes</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://larryeppes.site/EulerProject%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20-%20Mathematica/">https://larryeppes.site/EulerProject%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%20-%20Mathematica/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://larryeppes.site" target="_blank">Larry_Eppes's Trivia Collection Site</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/math/">math</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E5%AD%A6/">数学</a><a class="post-meta__tags" href="/tags/%E7%AE%97%E6%B3%95/">算法</a><a class="post-meta__tags" href="/tags/Mathematica/">Mathematica</a></div><div class="post_share"><div class="social-share" data-image="/img/0072Vf1pgy1fodqnrlkfxj31110q77sr.jpg" data-sites="wechat,weibo,qq,qzone"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/%E8%AF%81%E6%98%8E%E6%A0%B9%E5%8F%B72%E6%98%AF%E6%97%A0%E7%90%86%E6%95%B0/"><img class="prev-cover" src="/img/0072Vf1pgy1foxk3shjrpj31hc0u0k3d.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">证明根号2是无理数</div></div></a></div><div class="next-post pull-right"><a href="/%E6%9C%89%E7%90%86%E6%A0%B9%E5%88%A4%E5%88%AB%E6%B3%95/"><img class="next-cover" src="/img/0072Vf1pgy1fodqgm91nsj315o0xr4qq.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">有理根判别法</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/定理的各种名字/" title="定理的各种名字"><img class="cover" src="/img/2de8e90476400a10d395d368ea001710.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-26</div><div class="title">定理的各种名字</div></div></a></div><div><a href="/有理根判别法/" title="有理根判别法"><img class="cover" src="/img/0072Vf1pgy1fodqgm91nsj315o0xr4qq.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-26</div><div class="title">有理根判别法</div></div></a></div><div><a href="/证明根号2是无理数/" title="证明根号2是无理数"><img class="cover" src="/img/0072Vf1pgy1foxk3shjrpj31hc0u0k3d.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-11-26</div><div class="title">证明根号2是无理数</div></div></a></div><div><a href="/Latex编辑展示页面/" title="Latex编辑展示页面"><img class="cover" src="/img/0072Vf1pgy1foxkcymwgnj31kw0w0qsx.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-02</div><div class="title">Latex编辑展示页面</div></div></a></div><div><a href="/MSE问题集/" title="MSE问题集"><img class="cover" src="/img/0072Vf1pgy1foxkfzphb2j31hc0u0gvv.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-26</div><div class="title">MSE问题集</div></div></a></div><div><a href="/mathematica内置函数概览/" title="mathematica内置函数概览"><img class="cover" src="/img/a15b4afely1fnt9nsbnknj21hc0u0k6b.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-03-06</div><div class="title">mathematica内置函数概览</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Valine</span><span class="switch-btn"></span><span class="second-comment">Gitalk</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/head.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">Larry Eppes</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">52</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">78</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">19</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/larryeppes"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/larryeppes" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/img/wechat.png" target="_blank" title="微信"><i class="fab fa-weixin"></i></a><a class="social-icon" href="https://space.bilibili.com/343918736" target="_blank" title="BiliBili"><i class="fa fa-television"></i></a><a class="social-icon" href="mailto:larryleifeng@163.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">这是 Larry Eppes 的 blog, 仅做一些日常记录.</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-23"><span class="toc-number">1.</span> <span class="toc-text">Problem 23</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-24"><span class="toc-number">2.</span> <span class="toc-text">Problem 24</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-25"><span class="toc-number">3.</span> <span class="toc-text">Problem 25</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-27"><span class="toc-number">4.</span> <span class="toc-text">Problem 27</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-28"><span class="toc-number">5.</span> <span class="toc-text">Problem 28</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-29"><span class="toc-number">6.</span> <span class="toc-text">Problem 29</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-30"><span class="toc-number">7.</span> <span class="toc-text">Problem 30</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-31"><span class="toc-number">8.</span> <span class="toc-text">Problem 31</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-32"><span class="toc-number">9.</span> <span class="toc-text">Problem 32</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-33"><span class="toc-number">10.</span> <span class="toc-text">Problem 33</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-34"><span class="toc-number">11.</span> <span class="toc-text">Problem 34</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-35"><span class="toc-number">12.</span> <span class="toc-text">Problem 35</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-36"><span class="toc-number">13.</span> <span class="toc-text">Problem 36</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-37"><span class="toc-number">14.</span> <span class="toc-text">Problem 37</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-38"><span class="toc-number">15.</span> <span class="toc-text">Problem 38</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-39"><span class="toc-number">16.</span> <span class="toc-text">Problem 39</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-40"><span class="toc-number">17.</span> <span class="toc-text">Problem 40</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-41"><span class="toc-number">18.</span> <span class="toc-text">Problem 41</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Problem-42"><span class="toc-number">19.</span> <span class="toc-text">Problem 42</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/%E5%88%9D%E7%AD%89%E5%87%BD%E6%95%B0/" title="初等函数"><img src="/img/d3648db7aac4a79355e64d66b4f45ccb.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="初等函数"/></a><div class="content"><a class="title" href="/%E5%88%9D%E7%AD%89%E5%87%BD%E6%95%B0/" title="初等函数">初等函数</a><time datetime="2025-10-30T11:05:27.091Z" title="更新于 2025-10-30 19:05:27">2025-10-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E5%85%B3%E4%BA%8E%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/" title="关于高等数学"><img src="/img/45b30b18dc1d0de91fca56b03959380c.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="关于高等数学"/></a><div class="content"><a class="title" href="/%E5%85%B3%E4%BA%8E%E9%AB%98%E7%AD%89%E6%95%B0%E5%AD%A6/" title="关于高等数学">关于高等数学</a><time datetime="2025-10-30T10:40:15.391Z" title="更新于 2025-10-30 18:40:15">2025-10-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/VSCode%E5%BF%AB%E6%8D%B7%E8%BE%93%E5%85%A5%E9%85%8D%E7%BD%AE/" title="VSCode 快捷输入配置"><img src="/img/0bdfda67aa7b702aec88c35bb5a4d8eb.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="VSCode 快捷输入配置"/></a><div class="content"><a class="title" href="/VSCode%E5%BF%AB%E6%8D%B7%E8%BE%93%E5%85%A5%E9%85%8D%E7%BD%AE/" title="VSCode 快捷输入配置">VSCode 快捷输入配置</a><time datetime="2025-10-30T10:23:14.757Z" title="更新于 2025-10-30 18:23:14">2025-10-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/mathematica%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0%E6%A6%82%E8%A7%88/" title="mathematica内置函数概览"><img src="/img/a15b4afely1fnt9nsbnknj21hc0u0k6b.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="mathematica内置函数概览"/></a><div class="content"><a class="title" href="/mathematica%E5%86%85%E7%BD%AE%E5%87%BD%E6%95%B0%E6%A6%82%E8%A7%88/" title="mathematica内置函数概览">mathematica内置函数概览</a><time datetime="2024-11-08T05:36:28.552Z" title="更新于 2024-11-08 13:36:28">2024-11-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/%E5%B8%B8%E7%94%A8%E6%81%92%E7%AD%89%E5%BC%8F/" title="常用恒等式"><img src="/img/3f1ffa0a359d5afec8b4055d297a513d.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="常用恒等式"/></a><div class="content"><a class="title" href="/%E5%B8%B8%E7%94%A8%E6%81%92%E7%AD%89%E5%BC%8F/" title="常用恒等式">常用恒等式</a><time datetime="2024-11-08T04:08:32.407Z" title="更新于 2024-11-08 12:08:32">2024-11-08</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2025 By Larry Eppes</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (true){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      },
      load: ['input/tex-base', 'output/svg', 'ui/menu', '[tex]/configmacros', '[tex]/autoload', '[tex]/mathtools', '[tex]/ams', '[tex]/require']
    },
    tex: {
      packages: {'[+]': ['configmacros', 'autoload', 'mathtools', 'ams']},
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      displayMath: [             // start/end delimiter pairs for display math
        ['$$', '$$'],
        ['\\[', '\\]']
      ],
      tags: 'ams',
      macros: {
        RR: '\\mathbb{R}',
        QQ: '\\mathbb{Q}',
        ZZ: '\\mathbb{Z}',
        CC: '\\mathbb{C}',
        NN: '\\mathbb{N}',
        pNN: '\\mathbb{N}_+',
        ud: '\\mathrm{d}',
        ue: '\\mathrm{e}',
        ui: '\\mathrm{i}',
        udiv: '\\mathrm{div}',
        wc: '\\rightharpoonup',
        oint: '\u222e',
        oiint: '\u222f',
        oiiint: '\u2230',
        norm: ["\\left\\| #1 \\right\\|", 1],
        abs: ["\\left| #1 \\right|", 1]
      }
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>if (document.getElementsByClassName('mermaid').length) {
  if (window.mermaidJsLoad) mermaid.init()
  else {
    getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(() => {
      window.mermaidJsLoad = true
      mermaid.initialize({
        theme: 'forest',
      })
      false && mermaid.init()
    })
  }
}</script><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      master:'aa515fb49018426b37353dba8ee9295f',
      appId: 'tGC6nSdJ5VjiCKhKDPcXKqm6-MdYXbMMI',
      appKey: '32oq82lFTL3t75HT8Vkby2BU',
      placeholder: 'Please leave your footprints',
      avatar: 'mp',
      meta: 'nick,mail'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: true,
      serverURLs: 'https://tgc6nsdj.api.lncldglobal.com',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: true,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign(initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk({
      clientID: '4e8dae54dd4b05b79f59',
      clientSecret: 'a6c663b870303c2139e313b609d5025a8139f1bc',
      repo: 'larryeppes.github.io',
      owner: 'larryeppes',
      admin: ['larryeppes'],
      id: 'af98615ec73921cefda81c93bb126e4a',
      language: 'zh-CN',
      perPage: 10,
      distractionFreeMode: false,
      pagerDirection: 'last',
      createIssueManually: false,
      updateCountCallback: commentCount
    })
    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js').then(initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Valine' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>